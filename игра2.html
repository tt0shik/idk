<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–Ø–ø–æ–Ω—Å–∫–∏–π –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö ¬∑ –ò–≥—Ä–∞</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Hiragino Sans', 'Meiryo', sans-serif;
        }
        body {
            background: linear-gradient(145deg, #2b3a4a 0%, #1d2a35 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 48px 48px 32px 32px;
            padding: 28px 24px 36px;
            box-shadow: 0 25px 40px -12px rgba(0,0,0,0.6), 0 2px 10px 0 rgba(255,255,240,0.15) inset;
            border: 1px solid rgba(255, 240, 200, 0.25);
            max-width: 1000px;
            width: 100%;
        }
        h1 {
            text-align: center;
            margin: 0 0 12px 0;
            font-weight: 400;
            font-size: 2.2rem;
            letter-spacing: 4px;
            color: #f5e7d9;
            text-shadow: 2px 4px 6px #1f1a15;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        h1 span {
            background: #bfa98e;
            color: #1f2a33;
            font-size: 1.2rem;
            padding: 6px 16px;
            border-radius: 60px;
            box-shadow: inset 0 -3px 0 #6e5e4b;
            font-weight: 600;
        }
        .score-panel {
            display: flex;
            justify-content: space-between;
            background: #2e3c48c9;
            border-radius: 60px;
            padding: 10px 24px;
            margin: 8px 10px 28px 10px;
            color: #f2e0cd;
            border: 1px solid #b6a68b55;
            font-size: 1.3rem;
            font-weight: 500;
            backdrop-filter: blur(4px);
        }
        .score, .attempts {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .score span, .attempts span {
            background: #425563;
            padding: 6px 18px;
            border-radius: 40px;
            color: #faead6;
            font-weight: 700;
            font-size: 1.8rem;
            line-height: 1;
            min-width: 60px;
            text-align: center;
        }
        .attempts span {
            background: #6d4f3f;
        }
        .game-board {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 25px 0 15px;
        }
        .column {
            flex: 1 1 280px;
            background: #1e2b33d9;
            border-radius: 32px;
            padding: 22px 16px 22px;
            backdrop-filter: blur(6px);
            border: 2px solid #8f9a9e36;
            box-shadow: 0 6px 0 #0f171e;
        }
        .column h2 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 28px;
            font-weight: 400;
            color: #ffecd8;
            font-size: 1.8rem;
            border-bottom: 2px dashed #c2aa8b66;
            padding-bottom: 12px;
            letter-spacing: 2px;
        }
        .japanese-col h2 {
            color: #ffcf9a;
        }
        .russian-col h2 {
            color: #b5d0d9;
        }
        .card-list {
            display: flex;
            flex-direction: column;
            gap: 18px;
            align-items: stretch;
        }
        .word-card {
            background: #fbf3e8;
            background-image: radial-gradient(circle at 10px 20px, #ffffff90 1px, transparent 1px), 
                              linear-gradient(145deg, #fffaf0, #f5e5d0);
            padding: 20px 16px;
            border-radius: 24px;
            font-size: 1.9rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 8px 0 #8b6f54, 0 10px 18px rgba(0,0,0,0.3);
            transition: all 0.1s ease;
            cursor: pointer;
            user-select: none;
            border: 2px solid #ebcba0;
            color: #1c2a36;
            letter-spacing: 1px;
            touch-action: manipulation;
            word-break: break-word;
        }
        .japanese-card {
            font-size: 2.1rem;
            background: #fffaec;
            background-image: linear-gradient(145deg, #fff3e0, #fee9cf);
            border: 2px solid #dbbd96;
            box-shadow: 0 8px 0 #946b42;
        }
        .russian-card {
            font-size: 1.8rem;
            background: #ecf3f7;
            background-image: linear-gradient(145deg, #f0f8ff, #dee9f0);
            border: 2px solid #a5bccc;
            box-shadow: 0 8px 0 #5e707e;
            color: #11212e;
        }
        .word-card.selected {
            transform: translateY(-4px);
            box-shadow: 0 10px 0 #c2935e, 0 14px 22px black;
            filter: brightness(1.15);
            border: 3px solid #fdebb3;
        }
        .word-card.matched {
            opacity: 0.35;
            filter: grayscale(0.6);
            box-shadow: 0 4px 0 #5f5f5f;
            transform: translateY(4px);
            pointer-events: none;
            cursor: default;
            background: #bdbdbd;
            border-color: #8d8d8d;
            transition: all 0.2s;
        }
        .word-card:active:not(.matched):not(.selected) {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #7a623f;
        }
        .message-area {
            text-align: center;
            min-height: 70px;
            font-size: 1.7rem;
            padding: 16px 10px;
            color: #fadbb1;
            font-weight: 500;
            text-shadow: 2px 2px 0 #1d2a2e;
            letter-spacing: 1px;
        }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            margin: 20px 0 10px;
        }
        .btn {
            background: #e7cfb0;
            border: none;
            font-size: 1.4rem;
            font-weight: 600;
            padding: 16px 42px;
            border-radius: 50px;
            color: #1e2d39;
            box-shadow: 0 7px 0 #856e50, 0 8px 16px black;
            cursor: pointer;
            transition: 0.05s linear;
            letter-spacing: 1.5px;
            border: 1px solid #ffeaca;
            flex: 0 1 auto;
        }
        .btn:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #705d44, 0 5px 12px black;
        }
        .btn.reset {
            background: #c0cfde;
            box-shadow: 0 7px 0 #6b7f92;
            color: #0e222f;
        }
        .footer {
            text-align: center;
            color: #aebec9;
            font-size: 1.1rem;
            margin-top: 24px;
        }
        .footer a {
            color: #ffd8b0;
            text-decoration: none;
        }
        @media (max-width: 650px) {
            .game-container { padding: 20px 12px; }
            .word-card { font-size: 1.6rem; padding: 16px; }
            .japanese-card { font-size: 1.9rem; }
            .btn { padding: 14px 25px; font-size: 1.2rem; }
            h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
<div class="game-container">
    <h1>
        „Å´„Åª„Çì„Åî <span>–Ω–∞—á–∞–ª—å–Ω—ã–π</span>
    </h1>

    <div class="score-panel">
        <div class="score">‚úÖ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π <span id="scoreDisplay">0</span></div>
        <div class="attempts">üîÑ –ø–æ–ø—ã—Ç–∫–∞ <span id="attemptDisplay">0</span></div>
    </div>

    <div class="game-board" id="gameBoard">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (—è–ø–æ–Ω—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏) -->
        <div class="column japanese-col">
            <h2>üáØüáµ Êó•Êú¨Ë™û</h2>
            <div class="card-list" id="japaneseList"></div>
        </div>
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (–ø–µ—Ä–µ–≤–æ–¥—ã) -->
        <div class="column russian-col">
            <h2>üá∑üá∫ –ø–µ—Ä–µ–≤–æ–¥</h2>
            <div class="card-list" id="russianList"></div>
        </div>
    </div>

    <div class="message-area" id="message">‚úß  –≤—ã–±–µ—Ä–∏ —Å–ª–æ–≤–æ —Å–ª–µ–≤–∞, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≤–æ–¥ ‚úß</div>

    <div class="button-group">
        <button class="btn" id="newGameBtn">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
        <button class="btn reset" id="resetCurrentBtn">‚ü≤ –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä—ã</button>
    </div>
    <div class="footer">
        ‚õ©Ô∏è  —É—á–∏–º —Ö–∏—Ä–∞–≥–∞–Ω—É –∏ –ø–µ—Ä–≤—ã–µ —Å–ª–æ–≤–∞ ¬∑ <a href="#" id="shuffleHint">–ø–µ—Ä–µ–º–µ—à–∞—Ç—å</a>
    </div>
</div>

<script>
    (function() {
        // ----- –°–õ–û–í–ê–†–¨ (—è–ø–æ–Ω—Å–∫–∏–π -> —Ä—É—Å—Å–∫–∏–π, –Ω–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å) -----
        const PAIRS = [
            { ja: '„ÅÑ„Å¨', ru: '—Å–æ–±–∞–∫–∞' },
            { ja: '„Å≠„Åì', ru: '–∫–æ—à–∫–∞' },
            { ja: '„Å®„Çä', ru: '–ø—Ç–∏—Ü–∞' },
            { ja: '„Åï„Åã„Å™', ru: '—Ä—ã–±–∞' },
            { ja: '„Åç', ru: '–¥–µ—Ä–µ–≤–æ' },
            { ja: '„Åø„Åö', ru: '–≤–æ–¥–∞' },
            { ja: '„Å≤', ru: '–æ–≥–æ–Ω—å' },
            { ja: '„ÇÑ„Åæ', ru: '–≥–æ—Ä–∞' },
            { ja: '„ÅØ„Å™', ru: '—Ü–≤–µ—Ç–æ–∫' },
            { ja: '„ÅÇ„ÇÅ', ru: '–¥–æ–∂–¥—å' }
        ];

        // ----- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã -----
        let japaneseItems = [];          // –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ { id, text, pairId, matched }
        let russianItems = [];           // –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ { id, text, pairId, matched }
        let selectedId = null;           // ID –≤—ã–±—Ä–∞–Ω–Ω–æ–π —è–ø–æ–Ω—Å–∫–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ (–∏–ª–∏ null)
        let selectedElement = null;      // —Å—Å—ã–ª–∫–∞ –Ω–∞ DOM —ç–ª–µ–º–µ–Ω—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ (–¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏)
        let matchCount = 0;              // —Å–∫–æ–ª—å–∫–æ –ø–∞—Ä —Å–æ–±—Ä–∞–Ω–æ
        let attemptCount = 0;             // —Å—á—ë—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ (–Ω–µ—É–¥–∞—á–Ω—ã—Ö + —É—Å–ø–µ—à–Ω—ã—Ö)
        let gameFinished = false;

        // —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ id –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ (–ø—Ä–æ—Å—Ç—ã–µ —Å—á—ë—Ç—á–∏–∫–∏)
        let nextJapaneseId = 1;
        let nextRussianId = 1000;

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const japaneseListEl = document.getElementById('japaneseList');
        const russianListEl = document.getElementById('russianList');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const attemptDisplay = document.getElementById('attemptDisplay');
        const messageEl = document.getElementById('message');
        const newGameBtn = document.getElementById('newGameBtn');
        const resetCurrentBtn = document.getElementById('resetCurrentBtn');
        const shuffleHint = document.getElementById('shuffleHint');

        // –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –§–∏—à–µ—Ä–∞-–ô–µ—Ç—Å–∞
        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è / –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function initGameData() {
            // —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä—ã —Å pairId –æ—Ç 0 –¥–æ N-1
            const pairsCount = PAIRS.length;

            // —è–ø–æ–Ω—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            japaneseItems = PAIRS.map((pair, index) => ({
                id: nextJapaneseId++,
                text: pair.ja,
                pairId: index,
                matched: false
            }));

            // —Ä—É—Å—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            russianItems = PAIRS.map((pair, index) => ({
                id: nextRussianId++,
                text: pair.ru,
                pairId: index,
                matched: false
            }));

            // –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –æ–±–µ –∫–æ–ª–æ–¥—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
            japaneseItems = shuffleArray(japaneseItems);
            russianItems = shuffleArray(russianItems);

            matchCount = 0;
            attemptCount = 0;
            gameFinished = false;
            clearSelected();
        }

        // –°–±—Ä–æ—Å —Ç–æ–ª—å–∫–æ matched —Ñ–ª–∞–≥–æ–≤ (–ø–µ—Ä–µ–º–µ—à–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏, —Å–Ω—è—Ç—å matched, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫)
        function resetMatchedOnly() {
            // —Å–±—Ä–æ—Å–∏—Ç—å matched —É –≤—Å–µ—Ö
            japaneseItems.forEach(item => item.matched = false);
            russianItems.forEach(item => item.matched = false);
            // –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –ø–µ—Ä–µ–º–µ—à–∞—Ç—å –∫–∞–∂–¥—ã–π –º–∞—Å—Å–∏–≤ (—á—Ç–æ–±—ã –ø–æ–∑–∏—Ü–∏–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
            japaneseItems = shuffleArray(japaneseItems);
            russianItems = shuffleArray(russianItems);
            matchCount = 0;
            gameFinished = false;
            clearSelected();
        }

        // –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤–∞—è –∏–≥—Ä–∞ (–Ω–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
        function resetFullGame() {
            initGameData();
            renderBoard();
            updateMessage('–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞! –£–¥–∞—á–∏ „Åå„Çì„Å∞„Å£„Å¶');
        }

        // —Å–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ
        function clearSelected() {
            if (selectedElement) {
                selectedElement.classList.remove('selected');
                selectedElement = null;
            }
            selectedId = null;
        }

        // –æ–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫–∏
        function updateCounters() {
            scoreDisplay.textContent = matchCount;
            attemptDisplay.textContent = attemptCount;
            if (matchCount === PAIRS.length) {
                gameFinished = true;
                messageEl.textContent = 'üéâ  –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã —Å–æ–±—Ä–∞–ª –≤—Å–µ –ø–∞—Ä—ã!  üéâ';
            }
        }

        // —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (–µ—Å–ª–∏ –∏–≥—Ä–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–µ–Ω–∞)
        function updateMessage(text) {
            if (!gameFinished || matchCount === PAIRS.length) {
                messageEl.textContent = text;
            }
        }

        // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ —è–ø–æ–Ω—Å–∫—É—é –∫–∞—Ä—Ç–æ—á–∫—É
        function handleJapaneseClick(cardId) {
            if (gameFinished) {
                updateMessage('–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ù–∞—á–Ω–∏ –Ω–æ–≤—É—é –∏–ª–∏ —Å–±—Ä–æ—Å—å –ø–∞—Ä—ã.');
                return;
            }

            const card = japaneseItems.find(c => c.id === cardId);
            if (!card || card.matched) return; // –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ

            const cardElement = document.querySelector(`.japanese-card[data-id="${cardId}"]`);
            if (!cardElement) return;

            // –µ—Å–ª–∏ —Ç–∞ –∂–µ —Å–∞–º–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ ‚Äî —Å–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            if (selectedId === cardId) {
                clearSelected();
                updateMessage('–≤—ã–±–æ—Ä —Å–Ω—è—Ç');
                return;
            }

            // —Å–Ω–∏–º–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –±—ã–ª–æ
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }

            // —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            selectedId = cardId;
            selectedElement = cardElement;
            selectedElement.classList.add('selected');
            updateMessage(`–≤—ã–±—Ä–∞–Ω–æ: ${card.text} ‚Üí –∏—â–∏ –ø–µ—Ä–µ–≤–æ–¥`);
        }

        // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ —Ä—É—Å—Å–∫—É—é –∫–∞—Ä—Ç–æ—á–∫—É
        function handleRussianClick(cardId) {
            if (gameFinished) {
                updateMessage('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –ñ–º–∏ "–ù–æ–≤–∞—è –∏–≥—Ä–∞"');
                return;
            }

            const russianCard = russianItems.find(c => c.id === cardId);
            if (!russianCard || russianCard.matched) return;

            // –µ—Å–ª–∏ –Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —è–ø–æ–Ω—Å–∫–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
            if (selectedId === null) {
                updateMessage('‚úã —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —è–ø–æ–Ω—Å–∫–æ–µ —Å–ª–æ–≤–æ');
                return;
            }

            // –∏—â–µ–º —è–ø–æ–Ω—Å–∫—É—é –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ selectedId
            const japaneseCard = japaneseItems.find(c => c.id === selectedId);
            if (!japaneseCard || japaneseCard.matched) {
                // —Ç–∞–∫–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ –≤ —Ä–µ–¥–∫–∏—Ö –≥–æ–Ω–∫–∞—Ö? —Å–±—Ä–æ—Å–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                clearSelected();
                updateMessage('—á—Ç–æ‚Äë—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –≤—ã–±–µ—Ä–∏ –∑–∞–Ω–æ–≤–æ');
                renderBoard(); // –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã
                return;
            }

            // –ø—Ä–æ–≤–µ—Ä–∫–∞: —Å–æ–≤–ø–∞–¥–∞—é—Ç –ª–∏ pairId
            const isMatch = (japaneseCard.pairId === russianCard.pairId);

            // —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ (–ª—é–±–∞—è –ø–∞—Ä–∞ —è–ø–æ–Ω—Å–∫–∏–π -> —Ä—É—Å—Å–∫–∏–π)
            attemptCount++;
            attemptDisplay.textContent = attemptCount;

            if (isMatch) {
                // —É—Å–ø–µ—Ö: –ø–æ–º–µ—á–∞–µ–º –æ–±–µ –∫–∞—Ä—Ç–æ—á–∫–∏ matched
                japaneseCard.matched = true;
                russianCard.matched = true;
                matchCount++;
                scoreDisplay.textContent = matchCount;

                // —Å–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ, —Ç–∞–∫ –∫–∞–∫ –ø–∞—Ä–∞ —Å–æ–±—Ä–∞–Ω–∞
                clearSelected();

                // —Å–æ–æ–±—â–µ–Ω–∏–µ
                if (matchCount === PAIRS.length) {
                    updateMessage('‚≠ê  –ë–ª–µ—Å—Ç—è—â–µ! –¢—ã –≤—ã—É—á–∏–ª –≤—Å–µ —Å–ª–æ–≤–∞!  ‚≠ê');
                } else {
                    updateMessage('‚úÖ  –≤–µ—Ä–Ω–æ! –º–æ–ª–æ–¥–µ—Ü!');
                }

                // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å (–∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏)
                renderBoard();
            } else {
                // –Ω–µ—É–¥–∞—á–∞: –ø—Ä–æ—Å—Ç–æ —Å–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è
                clearSelected();
                updateMessage('‚ùå  –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–µ —Å–ª–æ–≤–æ');
                // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞, –ø—Ä–æ—Å—Ç–æ —É–±—Ä–∞–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ—Å–∫—É —á—Ç–æ–± —Å–Ω—è—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ
                renderBoard(); // –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä —Å–±—Ä–æ—Å–∏—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ä—ã–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è, –Ω–æ selected —É–∂–µ null
            }
        }

        // –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ–π –¥–æ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ japaneseItems / russianItems
        function renderBoard() {
            // –æ—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
            japaneseListEl.innerHTML = '';
            russianListEl.innerHTML = '';

            // –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —è–ø–æ–Ω—Å–∫–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
            japaneseItems.forEach(item => {
                const card = document.createElement('div');
                card.className = `word-card japanese-card ${item.matched ? 'matched' : ''}`;
                card.setAttribute('data-id', item.id);
                card.textContent = item.text;
                if (!item.matched) {
                    card.addEventListener('click', (e) => {
                        e.stopPropagation();
                        handleJapaneseClick(item.id);
                    });
                }
                japaneseListEl.appendChild(card);
            });

            // –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä—É—Å—Å–∫–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
            russianItems.forEach(item => {
                const card = document.createElement('div');
                card.className = `word-card russian-card ${item.matched ? 'matched' : ''}`;
                card.setAttribute('data-id', item.id);
                card.textContent = item.text;
                if (!item.matched) {
                    card.addEventListener('click', (e) => {
                        e.stopPropagation();
                        handleRussianClick(item.id);
                    });
                }
                russianListEl.appendChild(card);
            });

            // –µ—Å–ª–∏ –µ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π ID, –Ω–æ —ç–ª–µ–º–µ–Ω—Ç –≤–¥—Ä—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –º–∞—Ç—á–∏–Ω–≥ ‚Äî —Å–±—Ä–æ—Å–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
            if (selectedId) {
                const stillExists = japaneseItems.some(c => c.id === selectedId && !c.matched);
                if (!stillExists) {
                    clearSelected();
                } else {
                    // –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–¥—Å–≤–µ—Ç–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏)
                    const newSelectedEl = document.querySelector(`.japanese-card[data-id="${selectedId}"]`);
                    if (newSelectedEl && !newSelectedEl.classList.contains('matched')) {
                        if (selectedElement) selectedElement.classList.remove('selected');
                        selectedElement = newSelectedEl;
                        selectedElement.classList.add('selected');
                    } else {
                        clearSelected(); // –µ—Å–ª–∏ matched, —Å–±—Ä–æ—Å
                    }
                }
            }

            // –æ–±–Ω–æ–≤–∏–º —Å—á—ë—Ç—á–∏–∫–∏ –∏ —Ç–µ–∫—Å—Ç
            updateCounters();
            if (matchCount === PAIRS.length) {
                messageEl.textContent = 'üéâ  –ö–∞–º–ø–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!  üéâ';
            }
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ ---
        newGameBtn.addEventListener('click', () => {
            resetFullGame();
        });

        resetCurrentBtn.addEventListener('click', () => {
            if (japaneseItems.length === 0) {
                resetFullGame();
                return;
            }
            resetMatchedOnly();
            renderBoard();
            updateMessage('–ø–µ—Ä–µ–º–µ—à–∞–Ω–æ! –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞');
        });

        shuffleHint.addEventListener('click', (e) => {
            e.preventDefault();
            if (gameFinished && matchCount === PAIRS.length) {
                resetFullGame();
            } else {
                resetMatchedOnly();
                renderBoard();
                updateMessage('–∫–æ–ª–æ–¥–∞ –ø–µ—Ä–µ–º–µ—à–∞–Ω–∞');
            }
        });

        // –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        initGameData();
        renderBoard();
        updateMessage('‚úß  –≤—ã–±–µ—Ä–∏ —Å–ª–æ–≤–æ —Å–ª–µ–≤–∞, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≤–æ–¥ ‚úß');
    })();
</script>
</body>
</html>